<section class="container">
  <h2>Citas del día</h2>
  <section class="citas">
    <ng-container *ngIf="citasDelDia.length > 0; else sinCitasDelDia">
      <ng-container *ngFor="let cita of citasDelDia">
        <article class="card-cita">
          <h3>{{ cita.tipo_cita }}</h3>
          <p>{{ cita.fecha_y_hora | formatDateTime }}</p>
          <div class="opciones">
            <span (click)="perfilMascota(cita.id_cita)">
              <svg
                width="27"
                height="19"
                viewBox="0 0 27 19"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M20.8636 0C18.765 0 17.4886 0.391875 16.7523 0.724375C15.8073 0.273125 14.7273 0 13.5 0C12.2727 0 11.1927 0.273125 10.2477 0.724375C9.51136 0.391875 8.235 0 6.13636 0C2.45455 0 0 9.5 0 11.875C0 12.8606 1.62 13.7631 3.85364 14.1312C4.63909 16.7912 8.34545 18.8219 12.8864 19V13.9175C12.1623 13.4781 11.0455 12.6825 11.0455 11.875C11.0455 10.6875 13.5 10.6875 13.5 10.6875C13.5 10.6875 15.9545 10.6875 15.9545 11.875C15.9545 12.6825 14.8377 13.4781 14.1136 13.9175V19C18.6545 18.8219 22.3609 16.7912 23.1464 14.1312C25.38 13.7631 27 12.8606 27 11.875C27 9.5 24.5455 0 20.8636 0ZM3.86591 11.7206C3.25227 11.5781 2.77364 11.4119 2.45455 11.2812C2.76136 7.99188 5.15455 2.85 6.19773 2.375C6.86045 2.375 7.36364 2.44625 7.81773 2.50563C5.24045 5.24875 4.22182 9.5475 3.86591 11.7206ZM9.81818 9.5C9.49269 9.5 9.18053 9.37489 8.95037 9.15219C8.72021 8.92949 8.59091 8.62744 8.59091 8.3125C8.59091 7.67125 9.14318 7.125 9.81818 7.125C10.1437 7.125 10.4558 7.25011 10.686 7.47281C10.9162 7.69551 11.0455 7.99756 11.0455 8.3125C11.0455 8.9775 10.4932 9.5 9.81818 9.5ZM17.1818 9.5C16.8563 9.5 16.5442 9.37489 16.314 9.15219C16.0838 8.92949 15.9545 8.62744 15.9545 8.3125C15.9545 7.67125 16.5068 7.125 17.1818 7.125C17.5073 7.125 17.8195 7.25011 18.0496 7.47281C18.2798 7.69551 18.4091 7.99756 18.4091 8.3125C18.4091 8.9775 17.8568 9.5 17.1818 9.5ZM23.1341 11.7206C22.7782 9.5475 21.7595 5.24875 19.1823 2.50563C19.6364 2.44625 20.1395 2.375 20.8023 2.375C21.8455 2.85 24.2386 7.99188 24.5455 11.2812C24.2386 11.4119 23.76 11.5781 23.1341 11.7206Z"
                  fill="#205047"
                />
              </svg>
            </span>
            <ng-container *ngIf="!cita.tieneHistorial; else tieneHistorial">
              <span (click)="crearHistorial(cita.id_mascota, cita.id_cita)">
                <svg
                  width="19"
                  height="21"
                  viewBox="0 0 19 21"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M14.3735 9.94737L15.5705 8.55474C15.9885 8.06842 16.5205 7.80316 17.1 7.73684V6.63158L11.4 0H1.9C0.8455 0 0 0.983684 0 2.21053V17.6842C0 18.9 0.8455 19.8947 1.9 19.8947H7.6V17.8279L7.7235 17.6842H1.9V2.21053H8.55V9.94737H14.3735ZM10.45 1.65789L15.675 7.73684H10.45V1.65789ZM15.3235 11.97L17.2615 14.2247L11.438 21H9.5V18.7453L15.3235 11.97ZM18.8575 12.3679L17.9265 13.4511L15.9885 11.1963L16.9195 10.1132C17.1 9.8921 17.4135 9.8921 17.6035 10.1132L18.8575 11.5721C19.0475 11.7932 19.0475 12.1579 18.8575 12.3679Z"
                    fill="#205047"
                  />
                </svg>
              </span>
            </ng-container>
            <ng-template #tieneHistorial>
              <svg
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M19.5 15L14.5 20L11 16.5L12.5 15L14.5 17L18 13.5L19.5 15ZM2 0C0.89 0 0 0.9 0 2V18C0 19.11 0.89 20 2 20H9.81C9.45 19.38 9.2 18.7 9.08 18H2V2H9V7H14V11.08C14.33 11.03 14.67 11 15 11C15.34 11 15.67 11.03 16 11.08V6L10 0M4 10V12H12V10M4 14V16H9V14H4Z"
                  fill="#205047"
                />
              </svg>
            </ng-template>
          </div>
        </article>
      </ng-container>
    </ng-container>
    <ng-template #sinCitasDelDia>
      <p>No tienes citas hoy...</p>
    </ng-template>
  </section>

  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title><h3>Citas futuras</h3></mat-panel-title>
    </mat-expansion-panel-header>

    <section class="filtro">
      <mat-form-field>
        <mat-label>Filtrar por día</mat-label>
        <input
          matInput
          [matDatepicker]="picker"
          [(ngModel)]="fechaSeleccionada"
          (ngModelChange)="actualizarFiltro()"
        />
        <mat-datepicker-toggle
          matIconSuffix
          [for]="picker"
        ></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
    </section>

    <section class="citas">
      <ng-container *ngIf="citasFuturas.length > 0; else sinCitasFuturas">
        <ng-container *ngFor="let cita of citasFiltradas">
          <article class="card-cita">
            <h3>{{ cita.tipo_cita }}</h3>
            <p>{{ cita.fecha_y_hora | formatDateTime }}</p>
            <div class="opciones">
              <span class="editar" (click)="perfilMascota(cita.id_cita)">
                <svg
                  width="22"
                  height="16"
                  viewBox="0 0 22 16"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M17 0C15.29 0 14.25 0.33 13.65 0.61C12.88 0.23 12 0 11 0C10 0 9.12 0.23 8.35 0.61C7.75 0.33 6.71 0 5 0C2 0 0 8 0 10C0 10.83 1.32 11.59 3.14 11.9C3.78 14.14 6.8 15.85 10.5 16V11.72C9.91 11.35 9 10.68 9 10C9 9 11 9 11 9C11 9 13 9 13 10C13 10.68 12.09 11.35 11.5 11.72V16C15.2 15.85 18.22 14.14 18.86 11.9C20.68 11.59 22 10.83 22 10C22 8 20 0 17 0ZM3.15 9.87C2.65 9.75 2.26 9.61 2 9.5C2.25 6.73 4.2 2.4 5.05 2C5.59 2 6 2.06 6.37 2.11C4.27 4.42 3.44 8.04 3.15 9.87ZM8 8C7.73478 8 7.48043 7.89464 7.29289 7.70711C7.10536 7.51957 7 7.26522 7 7C7 6.46 7.45 6 8 6C8.26522 6 8.51957 6.10536 8.70711 6.29289C8.89464 6.48043 9 6.73478 9 7C9 7.56 8.55 8 8 8ZM14 8C13.7348 8 13.4804 7.89464 13.2929 7.70711C13.1054 7.51957 13 7.26522 13 7C13 6.46 13.45 6 14 6C14.2652 6 14.5196 6.10536 14.7071 6.29289C14.8946 6.48043 15 6.73478 15 7C15 7.56 14.55 8 14 8ZM18.85 9.87C18.56 8.04 17.73 4.42 15.63 2.11C16 2.06 16.41 2 16.95 2C17.8 2.4 19.75 6.73 20 9.5C19.75 9.61 19.36 9.75 18.85 9.87Z"
                    fill="#205047"
                  />
                </svg>
              </span>
            </div>
          </article>
        </ng-container>
      </ng-container>
      <ng-template #sinCitasFuturas>
        <p>No tienes citas futuras...</p>
      </ng-template>
    </section>
  </mat-expansion-panel>
</section>
